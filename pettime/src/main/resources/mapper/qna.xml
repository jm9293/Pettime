<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.admin.beans.QnaDAO">
	<select id="select" resultType="com.admin.beans.QnaDTO">
		SELECT *
		FROM QNA
		ORDER BY NUM DESC
	</select>
	
	<select id="selectPage" resultType="com.admin.beans.QnaDTO">
	<![CDATA[SELECT NUM, USERID, TITLE, CONTENT, VIEWCNT, WRDATE, ANSER, ANDATE, OPEN
FROM (
    SELECT ROW_NUMBER() OVER(ORDER BY NUM DESC) RN, 
        NUM, USERID, TITLE, CONTENT, VIEWCNT, WRDATE, ANSER, ANDATE, OPEN
    FROM QNA)  
WHERE RN BETWEEN ((#{param1}-1)*7)+1 AND ((#{param1}-1)*7)+7]]>

	</select>
	
	<select id="maxCnt" resultType="_int">
		SELECT count(*) 
		FROM QNA
	</select>
	
	<select id="selectPageBySearch" resultType="com.admin.beans.QnaDTO">
	<![CDATA[SELECT NUM, USERID, TITLE, CONTENT, VIEWCNT, WRDATE, ANSER, ANDATE, OPEN
FROM (
    SELECT ROW_NUMBER() OVER(ORDER BY NUM DESC) RN, 
        NUM, USERID, TITLE, CONTENT, VIEWCNT, WRDATE, ANSER, ANDATE, OPEN
    FROM QNA WHERE USERID LIKE #{param2} OR  TITLE LIKE #{param2} OR  CONTENT LIKE #{param2})  
WHERE RN BETWEEN ((#{param1}-1)*7)+1 AND ((#{param1}-1)*7)+7]]>

	</select>
	
	<select id="maxCntBySearch" resultType="_int">
		SELECT count(*) 
		FROM QNA WHERE USERID LIKE #{param2} OR  TITLE LIKE #{param2} OR  CONTENT LIKE#{param2}
	</select>
	
	<select id="selectByUid" resultType="com.admin.beans.QnaDTO">
		SELECT *
		FROM QNA WHERE NUM = #{param1}
	</select>
	
	<update id="addViewCnt">
		UPDATE QNA
		SET VIEWCNT = VIEWCNT+1 
        WHERE NUM = #{param1}
	</update>

	

</mapper>